
<html>
  <head>
    <title>ToolHub</title>
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/basic.css') }}">
    <script src="//code.jquery.com/jquery-2.2.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.2/jquery-ui.js" ></script>
  </head>
  <body>
  {% for item in datas %}
    <h1>{{item.name}}</h1>
    <form id='{{"form_"~item.source_file_name}}'>
        {{item.input_form.input.label}}
        {{item.input_form.input(size=50)}}
        {{item.input_form.hidden_tag()}}
		    <input type="submit" value="Run"/>
    </form>
    <textarea id='{{"output_"~item.source_file_name}}' style="resize:none" cols="100" rows="30" readonly="true"></textarea>
  {% endfor %}
  </body>
  {% for item in datas %}
    <script>
      $(document).ready(function() {
          $('{{"#form_"~item.source_file_name}}').submit(function (e) {
              var url = "{{ url_for('run_script') }}"; // send the form data here.
              var input = $('{{"#form_"~item.source_file_name}}').serializeArray();
              input.push({filename_without_extension: '{{item.source_file_name}}'});
              $.ajax({
                  type: "POST",
                  url: url,
                  datatype:"json",
                  data: input,
                  success: function(response) {
                      // do something with the response
                      $('{{"#output_"~item.source_file_name}}').val(response)
                      console.log("sajt--------------------------------------------:" + response);
                  }
              });
              e.preventDefault(); // block the traditional submission of the form.
          });
          // Inject our CSRF token into our AJAX request.
          $.ajaxSetup({
              beforeSend: function(xhr, settings) {
                  if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                      xhr.setRequestHeader("X-CSRFToken", "{{ item.input_form.csrf_token._value() }}")
                  }
              }
          })
      });


    </script>
  {% endfor %}
</html>
